<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HTML Quiz WebApp with Google Sign-In, Firestore, GSAP Animations</title>

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

// Your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAb3DUoDYJ1kvq23SiDI8PkTCvIt_ooUfM",
            authDomain: "html-quiz-webapp.firebaseapp.com",
            projectId: "html-quiz-webapp",
            storageBucket: "html-quiz-webapp.firebasestorage.app",
            messagingSenderId: "381717252465",
            appId: "1:381717252465:web:409a7de5a0487259ae0ed0",
            measurementId: "G-43P68MYVE0"
};

// Init Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();
const db = getFirestore(app);

window.addEventListener('DOMContentLoaded', () => {
  const loginPage = document.getElementById('loginPage');
  const sectionPage = document.getElementById('sectionPage');
  const profileName = document.getElementById('profileName');
  const profilePic = document.getElementById('profilePic');
  const signOutButton = document.getElementById('signOutButton');

  document.getElementById('googleSignInButton').addEventListener('click', async () => {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;
      profileName.textContent = user.displayName;
      profilePic.src = user.photoURL;

      loginPage.classList.add('hidden');
      sectionPage.classList.remove('hidden');

      // Animate sectionPage with GSAP and Anime.js
      gsap.from(sectionPage, { opacity: 0, duration: 1, y: -50 });
      anime({
        targets: '#profilePic',
        rotate: '1turn',
        scale: [0, 1],
        duration: 1200,
        easing: 'easeInOutExpo'
      });

      // Store user data in Firestore
      await setDoc(doc(db, "users", user.uid), {
        name: user.displayName,
        email: user.email,
        photoURL: user.photoURL,
        lastLogin: new Date()
      });

    } catch (error) {
      console.error(error);
      alert(`Google Sign-In failed: ${error.code} - ${error.message}`);
    }
  });

  signOutButton.addEventListener('click', async () => {
    await signOut(auth);
    sectionPage.classList.add('hidden');
    loginPage.classList.remove('hidden');
    alert("You have been signed out.");
  });
});
</script>
</head>

<body class="bg-gradient-to-br from-blue-900 to-blue-500 text-white min-h-screen flex flex-col items-center justify-center p-6">

<!-- Login Page -->
<div id="loginPage" class="flex flex-col space-y-4 w-full max-w-xs">
  <h1 class="text-2xl font-bold text-center">Login to Continue</h1>
  <button id="googleSignInButton" class="bg-red-600 hover:bg-red-700 p-2 rounded">Sign in with Google</button>
</div>

<!-- Section Page -->
<div id="sectionPage" class="hidden flex flex-col items-center space-y-4">
  <img id="profilePic" class="w-20 h-20 rounded-full border-4 border-white" alt="Profile Picture">
  <h2 id="profileName" class="text-xl font-semibold"></h2>
  <h1 class="text-2xl font-bold">Welcome to HTML Quiz</h1>
  <p>Select a quiz level to start.</p>
  <button class="bg-green-600 p-2 rounded">Basics</button>
  <button class="bg-yellow-600 p-2 rounded">Intermediate</button>
  <button class="bg-purple-600 p-2 rounded">Advanced</button>
  <button id="signOutButton" class="bg-gray-700 hover:bg-gray-800 p-2 rounded">Sign Out</button>
</div>

</body>
</html>
